\documentclass{xinzhewu}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{hyperref}
\usepackage[intoc, english]{nomencl}
\usepackage{enumerate}
\usepackage{multirow}
 \usepackage{enumitem} 
 \usepackage{multicol}
\usepackage{booktabs} % For formal tables
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage[scientific-notation=true]{siunitx}
\usepackage{algpseudocode}
\usepackage{svg}
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{listings}
\usepackage{nopageno}
\usepackage{color}
\usepackage{amsmath}
\usepackage{empheq}
\usepackage{enumerate}
\usepackage{mathrsfs}
\usepackage{siunitx}
\usepackage{xcolor,colortbl}
\usepackage{array}
\usepackage{latexsym}
\usepackage{amsfonts}
\usepackage{ulem}
\usepackage{smartdiagram}
\usepackage{easybmat}
\usepackage{graphicx}
%\usepackage[numbers]{natbib}
\usepackage{dirtree} % for directory structure.
\usepackage{diagbox} 
%\usepackage[Glenn]{fncychap}  %chapter styles
\usepackage{mathtools}

\usepackage{amssymb}

\usepackage{textpos}

\usepackage{csquotes}

\usepackage{algorithm, float}
\usepackage{algorithmicx}
\usepackage{algpseudocode}

\usepackage{xcolor}
\usepackage{enumerate}
\usepackage[scientific-notation=true]{siunitx}
\usepackage[misc]{ifsym}
\usepackage{booktabs} % Allows the use of \toprule, \midrule and \bottomrule in tables
\usepackage{amsmath}

\usepackage{easybmat}

\usepackage{minitoc} %List sections of chapter at beginning of that chapter


\usepackage{rotating}
\usepackage{pdflscape}


% Create a new environment for breaking code listings across pages.
\newenvironment{longlisting}{\captionsetup{type=listing}}{}


\newcolumntype{x}[1]{>{\centering\arraybackslash\hspace{0pt}}p{#1}}
\usepackage{makecell}

\usepackage{CJKutf8}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem{lemma}[theorem]{Lemma}

\makeatletter
\newcommand*\bigcdot{\mathpalette\bigcdot@{.5}}
\newcommand*\bigcdot@[2]{\mathbin{\vcenter{\hbox{\scalebox{#2}{$\m@th#1\bullet$}}}}}
\makeatother

\usepackage{rotating}

\usepackage{minted}

\usepackage[square,numbers]{natbib}
%\bibliographystyle{dinat}
\bibliographystyle{plainnat}

\setcounter{tocdepth}{3}
\setcounter{secnumdepth}{3}




% New definitions switch mode in Algorithm
\algnewcommand\algorithmicswitch{\textbf{switch}}
\algnewcommand\algorithmiccase{\textbf{case}}
\algnewcommand\algorithmicassert{\texttt{assert}}
\algnewcommand\Assert[1]{\State \algorithmicassert(#1)}%
% New "environments"
\algdef{SE}[SWITCH]{Switch}{EndSwitch}[1]{\algorithmicswitch\ #1\ \algorithmicdo}{\algorithmicend\ \algorithmicswitch}%
\algdef{SE}[CASE]{Case}{EndCase}[1]{\algorithmiccase\ #1}{\algorithmicend\ \algorithmiccase}%
%\algtext*{EndSwitch}%
%\algtext*{EndCase}%



\definecolor{maroon}{rgb}{0.5,0,0}
\definecolor{darkgreen}{rgb}{0,0.5,0}

\lstdefinelanguage{XML}
{
	basicstyle=\ttfamily,
	morestring=[s]{"}{"},
	morecomment=[s]{?}{?},
	morecomment=[s]{!--}{--},
	commentstyle=\color{darkgreen},
	moredelim=[s][\color{black}]{>}{<},
	moredelim=[s][\color{red}]{\ }{=},
	stringstyle=\color{blue},
	identifierstyle=\color{maroon}
}

\lstset{language=C++,
	basicstyle=\ttfamily,
	keywordstyle=\color{blue}\ttfamily,
	stringstyle=\color{red}\ttfamily,
	commentstyle=\color{green}\ttfamily,
	morecomment=[l][\color{magenta}]{\#}
}

%\renewcommand{\baselinestretch}{1.4}  % distance between two lines

\newenvironment{dedication}
{\clearpage           % we want a new page
	\thispagestyle{empty}% no header and footer
	\vspace*{\stretch{1}}% some space at the top 
	\itshape             % the text is in italics
	\raggedleft          % flush to the right margin
}
{\par % end the paragraph
	\vspace{\stretch{3}} % space at bottom is three times that at the top
	\clearpage           % finish off the page
}


\setcounter{tocdepth}{2}

\newcolumntype{x}[1]{>{\centering\arraybackslash\hspace{0pt}}p{#1}}

%\usepackage[UTF8]{ctex}
\hypersetup{colorlinks,linkcolor={blue},citecolor={blue},urlcolor={blue}} 

\makeatletter
\newenvironment{breakablealgorithm}
{% \\makeatletter begin{breakablealgorithm}
	\begin{center}
		\refstepcounter{algorithm}% New algorithm
		\hrule height.8pt depth0pt \kern2pt% \@fs@pre for \@fs@ruled
		\renewcommand{\caption}[2][\relax]{% Make a new \caption
			{\raggedright\textbf{\ALG@name~\thealgorithm} ##2\par}%
			\ifx\relax##1\relax % #1 is \relax
			\addcontentsline{loa}{algorithm}{\protect\numberline{\thealgorithm}##2}%
			\else % #1 is not \relax
			\addcontentsline{loa}{algorithm}{\protect\numberline{\thealgorithm}##1}%
			\fi
			\kern2pt\hrule\kern2pt
		}
	}{% \end{breakablealgorithm}
		\kern2pt\hrule\relax% \@fs@post for \@fs@ruled
	\end{center}
}
\makeatother


\renewcommand{\nomname}{List of Symbols}
\renewcommand{\nompreamble}{The next list describes several symbols that will be later used within the body of the document}

\title{\Large \textrm{Contribution \`a l’\'emergence de nouvelles m\'ethodes parall\`eles et reparties intelligentes utilisant un paradigme de programmation multi-niveaux pour le calcul extr\^eme}}

%\lesoustitre{Le sous titre est facultatif}

\discipline{Informatique}

\dirdethese{Serge G. Petiton}
\titredudirdethese{Universit\'e de Lille}

\jury{
	
\begin{tabular}{>{\normalsize}l>{\normalsize}l>{\small}l}
	&& \\
	Rapporteurs &  Michel Dayd\'e &- Directeur de l'IRT de Toulouse\\
	 &   &- Professeur \`a l'ENSEEIHT\\
	 &Michael A. Heroux &- Chercheur au Laboratoires National de Sandia \\
	Examinateurs & Yutong Lu &- Directrice de NSCC-Guangzhou \\
	&&- Professeur \`a l'Universit\'e de  Sun Yat-Sen\\
 	& Barbara Chapman  &-  Professeur \`a l'Universit\'e de Stony Brook\\
 	& &-  Chercheur au Laboratoires National de Brookhaven\\
 	&France Boillod-Cerneux& - Chercheur au CEA Saclay \\
	 & \textcolor{red}{A German ?} &-   \\
	Directeur & Serge G. Petiton &- Professeur \`a l'Universit\'e de Lille \\
\end{tabular}

}

\author{Xinzhe WU}

\date{Saclay, le 22 Mars 2019}

\nomdeuniversite{\textbf{\textrm{UNIVERSIT\'E DE LILLE}}}
\logouniversite{fig/lille.png} %nom du fichier
\scalelogouniversite{0.15} % mise a l'echelle de l'image (0.5=50% par exemple)
\logolabo{logo_labo}
\scalelogolabo{0.2}

\unite{Centre de Recherche en Informatique, Signal et Automatique de Lille}
\ecoledoc{\large École doctorale Sciences Pour l'Ing\'enieur Universit\'e Lille Nord-de-France}

\makenomenclature

\begin{document}

\maketitle
 
\clearemptydoublepage
\begin{dedication}
	\normalsize
	%This thesis is dedicated to my grandmother. Hope you can hear in the heaven.
	
	\vspace{0.2in}
	\begin{CJK*}{UTF8}{bsmi}
		{\CJKfamily{bkai}
			\large
			謹以此文獻給我的祖母劉占仙（1928-2015）}
	\end{CJK*}

\iffalse
\begin{textblock*}{\textwidth}(6cm,4cm)
	
	\begin{CJK*}{UTF8}{bsmi}
		\centerline{{\CJKfamily{bkai}戊戌年 $\bigcdot$小寒}}
		\centerline{{\CJKfamily{bkai}巴黎城}}
		\centerline{{\CJKfamily{bkai}歡鵲壘新巢}}
	\end{CJK*}
\end{textblock*}
\fi

\end{dedication}

\clearemptydoublepage

\chapter*{Acknowledgement}
\thispagestyle{empty}

First and foremost, I would like to express my gratitude to my advisor of the thesis, Prof. Serge G. Petiton, for the continuous support of my Ph.D. study and related research, for his patience, motivation, and immense knowledge. He enlightens me in the field of parallel computing and numerical algorithms. In addition, he has taught me how to conduct academic research in the past three years. I am grateful for his wise guidance and inclusiveness throughout my three years' study. I feel so lucky to work under his supervision.

I warmly thank Michel Dayd\'e, Professor at ENSEEIHT, and Micheal Heroux, senior scientist at Sandia National Laboratory. I feel really honored that they can be the reviewers of my thesis. Thanks for their revisions and relevant remarks. I would also like to thank all the members of my jury.

My sincere thanks also goes to the MYX project and CNRS for funding my thesis. I am grateful for the warm welcome shown by the Maison de la Simulation, especially Edouard Audit, for accepting me to study at this laboratory and funding me for several international conferences. I would also thank Val\'erie Belle and all secretary members for helping me with numerous administrative work. I thank all the people I met during these three years for the pleasant atmosphere they were able to install. 

I have been privileged to visit with National Supercomputing Center in Guangzhou. I would like to thank them, especially Prof. Yutong Lu for sharing their knowledge and I have benefited from the fruitful discussion with them.

I would like to thank ROMEO HPC Center, Universit\'e de Reims Champagne-Ardenne. They provide me the access to their supercomputer ROMEO (both 2013 and 2018 versions), which are the major platforms for the experimentation within my dissertation. I appreciate Dr. Arnaud RENARD and his engineering team for their technique supports.

Special thanks to my lovely friends in Paris for their help and encouragement. I am very thankful to have these friends who enrich my life with great happiness. It is hard to forget the days of drinking Chinese liquor together, which really eased my homesickness.

I also want to thank those who are dear to me. Their attentions and encouragements have accompanied me throughout this journey. I thank my parents for their support and unfailing confidence. Words cannot express how grateful I am to my mother and father for all of the sacrifices that you’ve made on my behalf. Thanks to my sister Kunze for being present at every moment.
	
At the end of this journey, I thank Yuxin for being able to accompany me in the best way and to continue to inspire me daily.


\clearemptydoublepage

\chapter*{Abstract}
\thispagestyle{empty}

Because of their simplicity and generality, Krylov iterative methods are frequently used on High-Performance Computing (HPC) systems to solve the extremely large linear systems and eigenvalue problems from science and engineering fields. With the increase of both number of computing units and the heterogeneity of supercomputers, time spent in the global communication and synchronization severely damage the parallel performance of iterative methods. Programming on supercomputers tends to be the intersection of distributed and parallel computing. Algorithm development should consider the principles: 1) multi-granularity parallelism; 2) hierarchical memory; 3) minimization of global communication; 4) promotion of the asynchronicity; 5) proposition of multi-level scheduling strategies and manager engines to handle huge traffic and improve the fault tolerance. 

In response to these goals, we present a distributed and parallel multi-level programming paradigm for Krylov methods on HPC platforms. The first part of our work focuses on an implementation of a scalable matrix generator to create test matrices with customized eigenvalue for benchmarking iterative methods on supercomputers. In the second part, we aim to study the numerical and parallel performance of proposed distributed and parallel iterative method. Its implementation with a manager engine and runtime can handle the huge communication traffic, fault tolerance, and reusability. In the third part, an auto-tuning scheme is introduced for the smart selection of its parameters at runtime. Finally, we analyse the possibility to implement the distributed and parallel paradigm by a graph-based workflow runtime environment.

\clearemptydoublepage

\chapter*{R\'esum\'e}
\thispagestyle{empty}

Les m\'ethodes it\'eratives de Krylov sont utilis\'ees sur les plate-formes de Calcul Haute Performance (CHP) pour r\'esoudre les grands syst\`emes linéaires issus des domaines de la science et de l'ing\'enierie, en raison de leur simplicit\'e et de leur g\'en\'eralit\'e. Avec l'augmentation du nombre de cœurs et de l'h\'et\'erog\'en\'eit\'e des superordinateurs, le temps consacr\'e \`a la communication et synchronisation globales nuit gravement aux leurs performances parall\`eles. La programmation tend \`a \^etre l'intersection du calcul distribu\'e et parall\`el. Le d\'eveloppement d'algorithmes devrait prendre en compte les principes: 1) parall\'elisme avec multi-granularit\'e; 2) m\'emoire hi\'erarchique; 3) minimisation de la communication globale; 4) promotion de l'asynchronicit\'e; 5) proposition de strat\'egies d'ordonnancement et de moteurs de gestion pour g\'erer les trafic et la tol\'erance aux pannes.

En r\'eponse \`e ces objectifs, nous pr\'esentons un paradigme de programmation multi-niveaux distribu\'es et parall\`els pour les m\'ethodes de Krylov sur les plates-formes de CHP. La premi\`ere partie porte sur la mise en œuvre d'un g\'en\'erateur de matrices avec des valeurs propres prescrites pour la r\'ef\'erence des m\'ethodes it\'eratives. Dans la deuxi\'eme partie, nous \'etudions les performances num\'eriques et parall\`eles de la m\'ethode it\'erative propos\'ee. Son impl\'ementation avec un moteur de gestion peut g\'erer le communication, la tol\'erance aux pannes et la réutilisabilit\'e. Dans la troisi\`eme partie, un sch\'ema de r\'eglage automatique est introduit pour la s\'election intelligente de ses param\`etres lors de l'ex\'ecution. Enfin, nous \'etudions la possibilit\'e d'impl\'ementer ce paradigme dans un environnement d'ex\'ecution de flux de travail.

\clearemptydoublepage

\selectlanguage{english}

\clearemptydoublepage

\frontmatter

{\tableofcontents}

{
\listoffigures
\addcontentsline{toc}{chapter}{\listfigurename}
}

{
\listoftables
\addcontentsline{toc}{chapter}{\listtablename}
}

{
\listofalgorithms
\addcontentsline{toc}{chapter}{\listalgorithmname}
}

\mbox{}
\input{Nomenclatures}

\printnomenclature[1.5in]

%\listoflistings


\mainmatter % Ne pas oublier, avec \frontmatter et \backmatter

\chapter{Introduction}

%\addcontentsline{toc}{chapter}{Introduction}
\input{Introduction}

\chapter{State-of-the-art in High-Performance Computing} \label{State-of-the-art in High-Performance Computing}

\input{Chapter2}

\chapter{Krylov Subspace Methods}\label{Krylov Subspace Methods}

\input{Chapter3}

\chapter{Sparse Matrix Generator with Given Spectra}\label{Sparse Matrix Generator with Given Spectra}

\input{Chapter4}

\chapter[Unite and Conquer GMRES/LS-ERAM Method (UCGLE)]{Unite and Conquer GMRES/LS-ERAM Method (UCGLE)}\label{Unite and Conquer GMRES/LS-ERAM Method}

\input{Chapter5}

\chapter{UCGLE for Linear Systems with Sequences of Right-hand-sides}\label{UCGLE for Linear Systems with Sequences of Right-hand-sides}

\input{Chapter6}

\chapter{UCGLE for Linear Systems with Multiple Right-hand-sides} \label{UCGLE for Linear Systems with Multiple Right-hand-sides}

\input{Chapter7}

\chapter{Parameters Autotuning}  \label{Parameters Autotuning}

\input{Chapter8}

\chapter{YML Programming Paradigm for Unite and Conquer Approach} \label{YML and XMP Multi-level Parallelism Programming Paradigm}

\input{Chapter9}

\chapter{Conclusion and Perspective} \label{Conclusion and Pespectives}

\input{Conclusion}

%\tableofcontents
\clearemptydoublepage

\addcontentsline{toc}{chapter}{Bibliography}
\bibliography{biblio}
\clearemptydoublepage

\appendix
\chapter{Scientific Communication}
%\addcontentsline{toc}{chapter}{Scientific Communication}

\input{Communication}

\clearemptydoublepage

\end{document}